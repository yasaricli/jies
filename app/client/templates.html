<head>
  <title>jies</title>
</head>

<template name="layout">
  {{> loginButtons }}
  <div id="Surface">
    {{ > yield }}
  </div>
</template>

<template name="index">
  {{#Â if currentUser }}
    <a href="{{ pathFor route='InsertCode' }}" class="btn btn-success push">New Function</a>
  {{/if}}
  {{ > codes }}
</template>

<template name="codes">
  <h2>All Codes</h2>
  {{# if Template.subscriptionsReady }}
    <ul>
      {{# each codes }}
        <li>
          <a href="{{ pathFor route='Code' username=user.username }}">
            <b>{{ user.username }}</b>:{{ name }}({{ installs.length }})
          </a>
        </li>
      {{/each}}
    </ul>
  {{ else }}
    loading..
  {{/if}}
</template>

<template name="code">
  {{# if code }}
    <h2>{{ code.user.username }}:{{ code.name }}</h2>
    <p>
      {{#markdown}}
        {{ code.desc }}
      {{/markdown}}
    </p>
    <textarea name="body">{{ code.body }}</textarea>

    {{# if code.isOwner }}
      <a class="btn btn-success" href="{{ pathFor route='UpdateCode' username=code.user.username name=code.name }}">
        Update
      </a>
      {{#quickRemoveButton collection="Codes" _id=code._id class="btn btn-danger" onSuccess=onSuccess }}
        Delete Function
      {{/quickRemoveButton}}
    {{/if}}

  {{ else }}
    not defined
  {{/if}}
</template>

<template name="profile">
  {{ > codes }}
</template>

<template name="insertCode">
  {{> quickForm collection="Codes" id="InsertCodeForm" type="insert" }}
</template>

<template name="updateCode">
  {{> quickForm collection="Codes" id="UpdateCodeForm" type="update" doc=code }}
</template>

<template name="loading">
  loading..
</template>
