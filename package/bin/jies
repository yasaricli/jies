#!/usr/bin/env node

var path = require('path'),
    Jies = require('../lib/core.js'),
    fs = require('fs'),
    _ = require('underscore');

// init require colors
require('colors');

var json = path.resolve('jies.json'),
    action = process.argv[2];

console.log('\nJies: Javascript Functions'.bold.blue);
console.log('------------------------------------------------\n'.bold.blue);

switch(action) {
  case 'init':
    var exampleJson = path.resolve(__dirname, '../example/jies.json'),
        content = fs.readFileSync(exampleJson, 'utf8');

    if(!fs.existsSync(json)) {
      fs.writeFileSync(json, content);
    }
  break;

  case 'install':
    var J = new Jies.Init();

    if (!fs.existsSync(json)) {
      return console.log('jies.json file does not exist!\n'.red.bold);
    }

    fs.readFile(json, 'utf8', function (err, data) {
      var options = JSON.parse(data);

      console.log('\n -- Started '+ options.name +' -- \n');

      J.include(options.functions, function(name) {
        console.log(name + ' --> included.');
      });
    });
  break;

  default:
    console.error('\nValid Actions'.bold);
    console.error('-------------'.bold);
    console.error('init          - Initialize a Jies project'.bold);
    console.error('install       - Install functions'.bold);
};
